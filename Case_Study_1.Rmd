---
title: "Case_Study _1"
author: "Matt_Paritosh"
date: "6/15/2019"
output: html_document
Keep_md: TRUE
---

```{r, echo = TRUE}
library(knitr)
library(downloader)
library(dplyr)
library(data.table)
library(ggplot2)
library(webshot)
library(kableExtra)

brewires<-read.csv("Brewries.csv")
BrewCount <- brewires %>% count(brewires$State)
names(BrewCount)<-c("State","No. of Brewires")

#Create styled table
BrewCount %>% kable() %>% kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

```{r}
#read.csv("beers.csv")
beers<-read.csv("beers.csv")

#Merge beers and Brewieres data frames into beers_brew
beers_brew<-merge(data.frame(beers),data.frame(brewires), by.x = "Brewery_id",by.y="Brew_ID")

#Update Column names
names(beers_brew) <- c("Brewery_ID", "Beer", "Beer_ID", "ABV", "IBU", "Beer_Syle", "Ounces", "Brewry_Name", "City", "State")

#First six observation
(head(beers_brew) %>% kable() %>% kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")))
```

```{r}
#Last six observation
tail(beers_brew) %>% kable(row.names = FALSE) %>% kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```


```{r}
#Total number of NA's in each column
totalna <-colSums(is.na(beers_brew))


#Create table of NA Vales
totalna %>% kable(col.names = c("Number_of_NA")) %>% kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

```{r}
#Create a data frame with only states, BeerID, ABV, and IBU
Mediantable <- data.frame(beers_brew$State,beers_brew$Beer_ID,beers_brew$ABV, beers_brew$IBU)

#Omit the NA values from Medaintable
MediantableNoNA <- na.omit(Mediantable, cols = c("beers_brew.ABV","beers_brew.IBU"), invert = FALSE)

#Create a function to calculate Mean
myFun <- function(x) { median = median(x)}

#Use the function to calculate the median for each state and Turn BeerMedianIBU into a dataframe
BeerMedianIBU <- as.data.frame.table(tapply(MediantableNoNA$beers_brew.IBU, MediantableNoNA$beers_brew.State, myFun))

#Rename columns of BeerMedianIBU table
names(BeerMedianIBU) <- c("State","Median_IBU")

#Remove SD NA Value
BeerMedianIBU <- BeerMedianIBU[-42,]

#Plot MedianIBU with ggplot
library(ggplot2)
p<-ggplot(BeerMedianIBU ,aes(reorder(BeerMedianIBU$State,-Median_IBU),Median_IBU, fill=BeerMedianIBU$State)) + geom_bar(stat='identity')+ theme(text=element_text(size=7),plot.title = element_text(hjust = 0.5),legend.position="none", axis.text.x = element_text(angle = 90))+ ggtitle("Beer Mediun IBU Per State") + labs(x = "State", y = "Median IBU")

#View Plot
p
```

```{r}
#Using the myFun Function calculate the Median ABV for each state and create a data frame
BeerMedianABV <- as.data.frame.table(tapply(MediantableNoNA$beers_brew.ABV, MediantableNoNA$beers_brew.State, myFun))

#Rename columns of BeerMedianABV table
names(BeerMedianABV) <- c("State", "Median_ABV")

#Remove NA Value SD

#Plot Median ABV
```


#### Colorado is the state with the highest alcohol beer in the US. The beer is "Lee Hill Vol.5 - Belgian Style Quadrupel Ale" the ABV is .128 (13% alcohol content). This beer is prodcuced by Uposlope Brewing Company.
```{r}
#View The row for maximum ABV value (Alcohol content)
kable(beers_brew[which.max(beers_brew$ABV),], format = "html")
```


#### Orgon is the state with the Bitterest Beer "Bitter Bitch Imperial IPA" this beer is 138 IBU and an American Double/Imperial IPA style. The brewery that produces this beer is Astroria Brewing Company.
```{r}
#View the row with max IBU value (bitterness)
kable(beers_brew[which.max(beers_brew$IBU),], format = "html", col.names = c("Brewery ID", "Beer", "Beer ID", "ABV", "IBU", "Beer Syle", "Ounces", "Brewry Name", "City", "State"))
                                                                             
                                                                            
```

#### ABV summary stats 
```{r}
#Summarise the ABV variable in the beer_brew table
ABVSummary <- summary(beers_brew$ABV)

#Create table 
kable(as.array(ABVSummary), format = "html", col.names = c("Statistic", "Value"))
```
